import{_ as C}from"./CompressorInit.5UZNF-Au.js";import{j as e}from"./jsx-runtime.l6YZH1ic.js";import{r as F}from"./index.OjgoNOWw.js";import{o as A,c as r,u as U,a as b}from"./transform.Ujq91x7g.js";import{Icon as a}from"./Icons.tgBymh6s.js";import{UploadCard as _}from"./UploadCard.f0jseQ6d.js";import{ProgressHint as P}from"./ProgressHint.136deGzg.js";import{FormatTag as S}from"./FormatTag.1xKqDJJT.js";import{f,c as u,t as w,g as E,a as L}from"./utils.laoKADR4.js";import{m as R}from"./index.HtDAqBSS.js";import{B as o}from"./button.ncRKj3GL.js";import{S as T}from"./index.1nf2E5ZO.js";import{U as I}from"./index.AGIWuGJs.js";import{T as n}from"./index.rPfIouvQ.js";import"./toArray.nS7GZgeY.js";import"./index.p7hr_Xrf.js";import"./WorkerCompress.SAZvOWsP.js";import"./WorkerPreview._eJF3rYI.js";import"./UploadDragger.ONu3kUQc.js";import"./usePaste.lqKQ1tp5.js";import"./reactNode.B2HQCb_2.js";import"./gapSize.O5Z3aApn.js";import"./progress.KQvPVk93.js";import"./Portal.Pe3gDrPT.js";import"./useSize.RVMIuZji.js";import"./CheckOutlined.P7VL5mZ2.js";import"./CloseOutlined.0lRK38iS.js";import"./index.9yN8RVW1.js";import"./KeyCode.at7loAuH.js";import"./useCSSVarCls.MDYFJu2S.js";import"./pickAttrs.PdgW-4Wc.js";import"./collapse.aS6vX33V.js";import"./EyeOutlined.kiebVQeb.js";const we=A(()=>{const[p,g]=R.useMessage(),[c,d]=F.useState(!1),l=r.hasTaskRunning();U();const v=async s=>(b(s),Promise.reject()),N=(s,t)=>{w(s,t),p.success("Download Success!")},y=async()=>{const s=await C(()=>import("./jszip.min.8gGKbKwA.js").then(j=>j.j),__vite__mapDeps([0,1])),t=new s.default,i=new Set;for(const[j,m]of r.list){const D=m.name,h=L(i,D);i.add(h),m.compress?.blob&&t.file(h,m.compress.blob)}return await t.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}})},z=async()=>{d(!0);const s=await y();w(URL.createObjectURL(s),"shoteasy.zip"),d(!1),p.success("Download Success!")},k=async()=>{const s=await window.showDirectoryPicker(),t=await E(s);t?.length&&t.map(i=>{b(i)})};let x=e.jsx(_,{});return r.list.size&&(x=e.jsxs("div",{className:"w-full bg-white shadow-md rounded-md overflow-hidden",children:[e.jsx(P,{}),e.jsx("div",{className:"p-4 grid gap-6",children:Array.from(r.list.values()).reverse().map(s=>e.jsxs("div",{className:"flex items-center justify-between pb-5 relative after:block after:absolute after:bottom-0 after:left-16 after:right-0 after:h-[1px] after:bg-slate-200",children:[e.jsxs("div",{className:"flex items-center max-w-[50%]",children:[e.jsx("img",{src:s.preview?.src||s.src,className:"w-[48px] h-[48px] flex-shrink-0 object-cover mr-4 rounded-sm aspect-[1/1]"}),e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("div",{className:"font-semibold mb-1.5 truncate",children:s.name}),e.jsxs("div",{className:"text-xs flex gap-1",children:[s.blob?.type&&e.jsx("span",{children:e.jsx(S,{type:s.blob.type.replace("image/","").toLocaleUpperCase()})}),e.jsx("span",{className:"text-xs",children:!s.compress?.width&&!s.compress?.height?"-":`${s.compress.width}*${s.compress.height}`}),e.jsx("span",{className:"text-xs",children:f(s.blob.size)})]})]})]}),s.compress&&e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"px-1 text-right",children:[e.jsxs("div",{className:"flex justify-end items-center gap-1",children:[e.jsxs("span",{className:"font-bold text-sm",children:[(Math.abs((s.compress.blob.size-s.blob.size)/s.blob.size)*100).toFixed(2),"%"]}),e.jsx(a,{name:"ArrowDown",size:"0.8em",className:u(s.blob.size>s.compress.blob.size?"text-green-600":"text-red-600")})]}),e.jsx("div",{className:"text-xs",children:e.jsx("span",{className:u(s.blob.size>s.compress.blob.size?"text-green-600":"text-red-600"),children:f(s.compress.blob.size)})})]}),e.jsx("div",{className:"p-1",children:e.jsx(o,{type:"primary",className:"bg-black",icon:e.jsx(a,{name:"Download"}),onClick:()=>N(s.compress.src,s.name)})})]}),!s.compress&&e.jsx("div",{className:"px-3",children:e.jsx(T,{})})]},s.key))})]})),e.jsxs(e.Fragment,{children:[g,r.list.size>0&&e.jsxs("div",{className:"flex gap-4 justify-center flex-col-reverse bg-white p-2 border-b shadow-md md:flex-row md:justify-between",children:[e.jsxs("div",{className:"flex gap-3 items-center justify-center",children:[e.jsx(I,{name:"file",beforeUpload:v,showUploadList:!1,children:e.jsx(o,{disabled:l,icon:e.jsx(a,{name:"ImagePlus"}),children:"Add Images"})}),!!window.showDirectoryPicker&&e.jsx(o,{disabled:l,icon:e.jsx(a,{name:"FolderPlus"}),onClick:k,children:"Add Folder"})]}),e.jsxs("div",{className:"flex gap-3 items-center justify-center",children:[e.jsx(n,{placement:"top",title:"Recompress",children:e.jsx(o,{disabled:l,loading:c,icon:e.jsx(a,{name:"RotateCw"}),onClick:()=>{r.reCompress()}})}),e.jsx(n,{placement:"top",title:"Download all using zip",children:e.jsx(o,{type:"primary",className:"bg-black",disabled:l,loading:c,icon:e.jsx(a,{name:"Download"}),onClick:z,children:"Download All"})}),e.jsx(n,{placement:"top",title:"Clear all",children:e.jsx(o,{type:"text",loading:c,icon:e.jsx(a,{name:"Eraser"}),onClick:()=>{r.list.clear()}})})]})]}),e.jsx("div",{className:"relative min-h-[200px] p-5",children:e.jsx("div",{className:"flex w-full justify-center z-10",children:x})})]})});export{we as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["_astro/jszip.min.8gGKbKwA.js","_astro/index.OjgoNOWw.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}